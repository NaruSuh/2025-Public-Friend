{% extends "base.html" %}
{% block content %}
  {% if error %}
    <div class="alert error">{{ error }}</div>
  {% endif %}
  <section class="panel">
    <h2>수료증 ZIP 생성하기</h2>
    <form action="/" method="post" enctype="multipart/form-data" class="form-grid">
      <label>
        응답 시트 (Excel/CSV)
        <input type="file" name="sheet" accept=".xlsx,.xls,.xlsm,.csv" required />
      </label>
      <label>
        설정 파일 (선택, YAML)
        <input type="file" name="config" accept=".yaml,.yml" />
      </label>
      <label>
        시트 이름 (옵션)
        <input type="text" name="sheet_name" placeholder="예: Form Responses 1" />
      </label>
      <label>
        최대 발급 수 (옵션)
        <input type="number" name="limit" min="1" placeholder="예: 50" />
      </label>
      <button type="submit">ZIP 생성</button>
    </form>
  </section>

  <section class="panel info">
    <h3>사용 팁</h3>
    <ul>
      <li>`config.example.yaml` 을 참고해 행사명/필터 조건을 YAML 로 저장 후 업로드하면 동일한 스타일로 발급됩니다.</li>
      <li>설정 파일을 생략하면 기본 템플릿이 사용됩니다.</li>
      <li>응답 시트는 Google Form 에서 내려받은 Excel/CSV 원본을 그대로 사용하면 됩니다.</li>
      <li>CLI 로 직접 실행하려면 `python -m certgen responses.xlsx --config config.yaml --output output` 을 이용하세요.</li>
    </ul>
  </section>
{% endblock %}
